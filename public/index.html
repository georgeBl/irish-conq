<!DOCTYPE html>
<meta charset="utf-8">

<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
    <script src="https://npmcdn.com/bootstrap@4.0.0-alpha.5/dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-selection.v1.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/dist/domjson.min.js"></script>
</head>

<body>
    <h2>Click on a path to load a question</h2>




    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">
                        <script>


                        </script>
                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
                </div>
                <div class="modal-body" id="question">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="firstAnswer"></button>
                    <button type="button" class="btn btn-secondary" id="secondAnswer" dismiss="modal"></button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="thirdAnswer"></button>
                    <button type="button" class="btn btn-secondary" id="forthAnswer" dismiss="modal"></button>
                </div>
            </div>
        </div>
    </div>





    <script>
        
        
            //old question
//        var question = "What is the population of Ireland?";
//        var answer = ["4.7", "3.5", "6.2", "5.2"];
        var question = [];
        var answer = [];
        
        socket.on("question table", function(questionTable){
           console.log("Question table event received");
           question = questionTable; 
           console.log(question);
        });
        
        
        var socket = io();
        d3.xml("/svg/irelandLow.svg").mimeType("image/svg+xml").get(function(error, xml) {
            if (error) throw error;
            document.body.appendChild(xml.documentElement);

            d3.select("g").attr("transform", "scale(0.7)");
            d3.select("svg").attr("width", 500);
            d3.select("svg").attr("height", 600);

            var svg = d3.select("body").select("svg");
            svg.selectAll("path").on("click", function() {
                $('#myModal').modal('toggle');

                $("#exampleModalLabel").html("Question Example");
                $("#question").html(question);
                $("#firstAnswer").html(answer[0]);
                $("#secondAnswer").html(answer[1]);
                $("#thirdAnswer").html(answer[2]);
                $("#forthAnswer").html(answer[3]);

                var pathId = $(this).get(0).id;
                $("#firstAnswer").click(function() {
                    socket.emit('right answer', pathId);
                    console.log("Right answer event emitted!");
                    $('#' + pathId).css("fill", "yellow");
                });





            });

            socket.on('right answer', function(ter) {
                console.log("Right answer event received");
                $('#' + ter).css("fill", "yellow");
                console.log("HEEEY");
            });

        });

    </script>
